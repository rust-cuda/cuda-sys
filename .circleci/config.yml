version: 2

.cargo: &cargo
  name: Cargo build
  command: |
    export PATH=/root/.cargo/bin:$PATH
    cargo build -vv

.job_template: &job_apt
  steps:
    - checkout
    - run:
        name: Install Rust
        command: |
          apt update
          apt install -y curl
          curl https://sh.rustup.rs -sSf | sh -s -- -y
    - run:
        <<: *cargo

jobs:
  latest:
    <<: *job_apt
    docker:
      - image: nvidia/cuda:latest

workflows:
  version: 2
  tests:
    jobs:
      - latest
